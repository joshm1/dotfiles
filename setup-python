#!/bin/bash

[ -z "$DOTFILES" ] && source ./utils.sh

echo "Setting up Python with asdf..."

# Install Python plugin for asdf if not already installed
if ! asdf plugin list | grep python >/dev/null; then
  echo "Adding asdf python plugin..."
  asdf plugin add python
fi

# Install default Python version if not already installed
if ! asdf list python | grep $DEFAULT_PYTHON_VERSION >/dev/null; then
  echo "Installing Python $DEFAULT_PYTHON_VERSION..."
  asdf install python $DEFAULT_PYTHON_VERSION
else
  echo "Python $DEFAULT_PYTHON_VERSION has already been installed."
fi

# Set global Python version
echo "Setting Python $DEFAULT_PYTHON_VERSION as global version..."
asdf set --home python $DEFAULT_PYTHON_VERSION

echo "Python setup complete!"
echo "Current Python version: $(python --version)"
