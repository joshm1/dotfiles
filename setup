#!/bin/zsh -e

source ./utils.sh

git submodule update --init

# macOS config
defaults write com.apple.finder AppleShowAllFiles YES.

# link dotfiles
[ -d $DOTFILES ] || symlink $HOME/projects/joshm1/dotfiles $DOTFILES

mkdir -p $HOME/.config

symlink $DOTFILES/git/gitconfig $HOME/.gitconfig
symlink $DOTFILES/git/gitignore $HOME/.gitignore

symlink $DOTFILES/ruby/gemrc $HOME/.gemrc

symlink $DOTFILES/.tmux.conf $HOME/.tmux.conf
symlink $DOTFILES/.config/tmux $HOME/.config/tmux
symlink $DOTFILES/.config/tmux-powerline $HOME/.config/tmux-powerline
symlink $DOTFILES/.config/nvim $HOME/.config/nvim
symlink $DOTFILES/.tool-versions.home $HOME/.tool-versions

source ./setup-homebrew
source ./setup-zsh
source ./setup-vim
# run this lazily when we call asdf for the first time
# source ./setup-asdf

# asdf-based setups
source ./setup-python
source ./setup-uv
source ./setup-nodejs
source ./setup-ruby

# fzf: install useful keybindings and fuzzy completion
[[ ! -f ~/.fzf.zsh ]] && /opt/homebrew/opt/fzf/install

# private config files should be in Dropbox
source ./setup-dropbox

# zsh-history has dropbox dependency
source ./setup-zsh-history

source ./setup-postgres

# clone oh-my-zsh - do not run installer because our .zshrc already has includes the oh-my-zsh config
# [[ ! -d ~/.oh-my-zsh ]] && \
#   git clone https://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh
