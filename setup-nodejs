#!/bin/bash

[ -z "$DOTFILES" ] && source ./utils.sh

echo "Setting up Node.js with asdf..."

# Install Node.js plugin for asdf if not already installed
if ! asdf plugin list | grep nodejs >/dev/null; then
  echo "Adding asdf nodejs plugin..."
  asdf plugin add nodejs
fi

# Install default Node.js version if not already installed
if ! asdf list nodejs | grep $DEFAULT_NODE_VERSION >/dev/null; then
  echo "Installing Node.js $DEFAULT_NODE_VERSION..."
  asdf install nodejs $DEFAULT_NODE_VERSION
else
  echo "Node.js $DEFAULT_NODE_VERSION has already been installed."
fi

# Set global Node.js version
echo "Setting Node.js $DEFAULT_NODE_VERSION as global version..."
asdf set --home nodejs $DEFAULT_NODE_VERSION

echo "Node.js setup complete!"
echo "Current Node.js version: $(node --version)"
echo "Current npm version: $(npm --version)"
